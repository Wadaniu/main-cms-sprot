{extend name="common/base"/}
{block name="body"}
<div class="container">
    {include file="assembly/crumbs"/}
    <div class="model">
        {include file="assembly/subnav" subnav="subnav('直播')"/}
        <div class="play-list">
            {foreach $data as $key=>$item}
            <p class="play-date">{$key}</p>
            <dl class="list-cont">
                {foreach $item as $i=>$team}
                <dd class="<?php echo getzt($team['status_id'],2,$team['sphere_type']) ?>">
                    <a href="/live-{$team.sphere_type}/{$team.comp_py}/{$team.id}.html">
                        <span class="type-name">{$team.competition_text}</span>
                        <ul>
                            <li><span class="time">{$team.match_time|date='H:i'}</span><span class="team"><img src="{$team.home_team_logo}">{$team.home_team_text}</span><span class="scores">{$team.sphere_type=='zuqiu'?$team.home_scores[0]:getScore($team.home_scores)}</span></li>
                            <li><span class="zt">{$team.status_text}</span><span class="team"><img src="{$team.away_team_logo}">{$team.away_team_text}</span><span class="scores">{$team.sphere_type=='zuqiu'?$team.away_scores[0]:getScore($team.away_scores)}</span></li>
                        </ul>
                        <p class="zttxt"><?php echo getzt($team['status_id'],1,$team['sphere_type']) ?></p>
                    </a>
                </dd>
                {/foreach}
            </dl>
            {/foreach}
        </div>
    </div>
</div>
{/block}
{block name="script"}
<script>
    $(function () {
        if ($(".tool").length > 0) {
            let index = $(".play-list .over").last().parent().index();
            let ywj = $(".play-list").children();
            let wks = ywj.splice(index + 1);

            let spdom = $("<dl class=list-cont></dl>")
            $.each($(ywj[1]).children(), function (i, item) {
                if (!$(item).hasClass('over')) {
                    spdom.append(item)
                }
            })
            if (spdom.children().length) {
                wks.unshift(spdom[0])
                wks.unshift(ywj[0])
            }

            // for (let i = 0; i < ywj.length; i += 2) {
            //     [ywj[i], ywj[i + 1]] = [ywj[i + 1], ywj[i]];
            //     let dom = $(ywj[i]).children().get().reverse();
            //     $(ywj[i]).empty().append(dom)
            // }

            $(".tool a").click(function () {
                $(".play-list").empty();
                $(this).addClass('cur').siblings().removeClass('cur');
                let index = $(this).index();
                let fragment = document.createDocumentFragment();
                switch (index) {
                    case 0:
                        $.each(wks, function (i, item) {
                            fragment.append(item)
                        })
                        break;
                    case 1:
                        $.each(ywj, function (i, item) {
                            fragment.append(item)
                        })
                        break;
                }
                $(".play-list").append(fragment);
                if ($(".play-list").children().length == 0) {
                    $(".play-list").append(`<p class=nodata>近期暂无${$(".hotnav .cur").text()}直播</p>`)
                }
            })
            $(".tool a").eq(0).trigger('click');
        }
    })
</script>
{/block}